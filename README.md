# Паттерн Map Reduce исполненный в конкурентном режиме подсчёта значений

## Общие моменты для кода 3-х похожих функций  в программе
1. Инициализация выходного результата Map или Chan
2. Мьютекс блокировки общего кода ``var mu sync.Mutex``
3. Инициализация группы ожидания ``var wg sync.WaitGroup ``
4. Цикл по входным элементам и всегда в начале блока цикла стоит `wg.Add(1)` для подсчёта горутин
5. Запуск горутины в цикле и в горутине всегда в начале стоит ``defer wg.Done() ``. Дальше идёт выполнение горутины
и результат заносится в общий результирующий Map или Chan
6. Ниже горутины имеются коды завсиящие от того какого типа результирующая структура данных - Map или канал Chan.
Если канал Chan то применяется ещё одна горутина ожидания для того чтобы выполнить закрытие канала chan
```go
go func() {
		wg.Wait()  //Ожидание когда счётчик 0
		close(out) //Закрытие канала
	}()
```
Если же просто Map, то ожидание выглядит таким образом ``wg.Wait()``. Хотя там горутина необязательная и работал бы и такой код:
```go
	wg.Wait()  //Ожидание когда счётчик 0
		close(out) //Закрытие канала
```
Но закрывать канал нужно обязательно: 1) чтобы уведомить получателей что больше не будет данных, 2) избежать бесконечного ожидания
данных, 3) предоствратить утечку ресурсов, 4) предотвратить запись ошибочных данных когда канал закрыт.
Закрывает канал всегда отправитель
 